---
title: "FTIC's Dashboard"
output: 
  flexdashboard::flex_dashboard:
    theme: cerulean
    orientation: rows
    vertical_layout: fill
    social: ["twitter", "facebook","menu"]
---

```{r setup, include=FALSE}
library(flexdashboard)
library(knitr)
library(DT)
library(rpivotTable)
library(ggplot2)
library(plotly)
library(dplyr)
library(openintro)
library(highcharter)
library(readr)
```

```{r}
myFTIC <- FTIC_ALL_APR_CRDV1 <- read_csv("FTIC_ALL_APR_CRDV1.csv",  col_types = cols(X1 = col_skip())) %>%  group_by(STU_ID)
#%>% filter(NumFallTerms== max(NumFallTerms))
myFTIC2015 <- myFTIC %>% filter(Cohort==2015& Stu_DEMO_TIME_FRAME.y==max(Stu_DEMO_TIME_FRAME.y))
myFTIC2016 <- myFTIC %>% filter(Cohort==2016& Stu_DEMO_TIME_FRAME.y==max(Stu_DEMO_TIME_FRAME.y))
myFTIC2017 <- myFTIC %>% filter(Cohort==2017& Stu_DEMO_TIME_FRAME.y==max(Stu_DEMO_TIME_FRAME.y))
myFTIC2018 <- myFTIC %>% filter(Cohort==2018& Stu_DEMO_TIME_FRAME.y==max(Stu_DEMO_TIME_FRAME.y))
myFTIC2019 <- myFTIC %>% filter(Cohort==2019& Stu_DEMO_TIME_FRAME.y==max(Stu_DEMO_TIME_FRAME.y))

```
```{r}
mycolors <- c("blue","#FFC125","darkgreen","darkorange" )
```

Interactive Data Visualization
======================================================================

Row
----------------------------------------------------------------------

### FTIC GPA and Credit Hours (CRD) Analysis

```{r}
valueBox(paste("FTIC size Trends"), color="orange")
```

### Total Numbers of FTIC with GPA APR in UWF Fall 2019

```{r}
myFTICsize <- myFTIC %>% group_by(STU_ID) %>%  filter( NumFallTerms == min(NumFallTerms) )
valueBox(length(unique(myFTICsize$STU_ID)), icon="Total-GPA-FTICs", caption = "FT15-19")
```

### FTIC-2013

```{r}
valueBox(sum(myFTICsize$Cohort==2013), caption = "FT13")
```

### FTIC-2014

```{r}
valueBox(sum(myFTICsize$Cohort==2014), caption = "FT14")
```


### FTIC-2015

```{r}
valueBox(sum(myFTICsize$Cohort==2015), caption = "FT15")
```

### FTIC-2016

```{r}
valueBox(sum(myFTICsize$Cohort==2016), caption = "FT16")
```

### FTIC-2017

```{r}
valueBox(sum(myFTICsize$Cohort==2017), caption = "FT17")
```

### FTIC-2018

```{r}
valueBox(sum(myFTICsize$Cohort==2018), caption = "FT18")
```

### FTIC-2019

```{r}
valueBox(sum(myFTICsize$Cohort==2019), caption = "FT19")
```

### FTIC-2020

```{r}
valueBox(sum(myFTICsize$Cohort==2020), caption = "FT20")
```


Row
-----------------------------------------------------------------------

### GPA by FTIC

```{r}
valueBox(paste("APRGPA Y1 Trends"), color="lightgreen")
```

### Total Numbers of FTIC with GPA APR in UWF 

```{r}
myFTICGPAAPR <- myFTIC %>% group_by(STU_ID) %>%  filter(GPAAPRind=="GPAAPR" & NumFallTerms==2 )
valueBox(length(myFTICGPAAPR$STU_ID), icon="Total-GPACRD-FTICs", caption = "FT13-19")
```


### FTIC - 2013

```{r}
valueBox(sum(myFTICGPAAPR$Cohort==2013),  caption  = "FT13")
```

### CASSH

```{r}
valueBox(sum(myFTICGPAAPR$Cohort==2014),  caption  = "FT14")
```

### COB

```{r}
valueBox(sum(myFTICGPAAPR$Cohort==2015),  caption  = "FT15")

```

### UKCOH

```{r}
valueBox(sum(myFTICGPAAPR$Cohort==2016),  caption  ="FT16")

```

### CEPS

```{r}
valueBox(sum(myFTICGPAAPR$Cohort==2017), caption  ="FT17")

```

### No college designated

```{r}
valueBox(sum(myFTICGPAAPR$Cohort==2018), caption  ="FT18")

```

### FTIC - 2019

```{r}
valueBox(sum(myFTICGPAAPR$Cohort==2019), caption  = "FT19")

```

Row
-----------------------------------------------------------------------

### GPA + CRD y1 by FTIC

```{r}
valueBox(paste("GPACRD Y1 Trends "), color="lightblue")
```

### Total Numbers of FTIC with GPA APR in UWF 

```{r}
myFTICGPACRDAPR <- myFTIC %>% group_by(STU_ID) %>%  filter(CRDGPAAPR=="GPACRDAPR" & NumFallTerms==2)
valueBox(length(myFTICGPACRDAPR$STU_ID), icon="Total-GPACRD-FTICs", caption = "FT13-19")
```


### FTIC - 2013

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2013),  caption  = "FT13")
```

### CASSH

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2014),  caption  = "FT14")
```

### COB

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2015),  caption  = "FT15")

```

### UKCOH

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2016),  caption  ="FT16")

```

### CEPS

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2017), caption  ="FT17")

```

### No college designated

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2018), caption  ="FT18")

```

### FTIC - 2019

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2019), caption  = "FT19")

```

Row
-----------------------------------------------------------------------

### GPA + CRD Y2 by FTIC

```{r}
valueBox(paste("GPACRD Y2 Trends "), color="lightblue")
```

### Total Numbers of FTIC with GPA APR in UWF 

```{r}
myFTICGPACRDAPR <- myFTIC %>% group_by(STU_ID) %>%  filter(CRDGPAAPR=="GPACRDAPR" & NumFallTerms == 3)
valueBox(length(myFTICGPACRDAPR$STU_ID), icon="Total-GPACRD-FTICs", caption = "FT13-19")
```


### FTIC - 2013

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2013),  caption  = "FT13")
```

### CASSH

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2014),  caption  = "FT14")
```

### COB

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2015),  caption  = "FT15")

```

### UKCOH

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2016),  caption  ="FT16")

```

### CEPS

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2017), caption  ="FT17")

```

### No college designated

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2018), caption  ="FT18")

```

### FTIC - 2019

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2019), caption  = "FT19")

```

Row
-----------------------------------------------------------------------

### GPA + CRD Y3 by FTIC

```{r}
valueBox(paste("GPACRD Y3 Trends "), color="lightblue")
```

### Total Numbers of FTIC with GPA APR in UWF 

```{r}
myFTICGPACRDAPR <- myFTIC %>% group_by(STU_ID) %>%  filter(CRDGPAAPR=="GPACRDAPR" & NumFallTerms ==4)
valueBox(length(myFTICGPACRDAPR$STU_ID), icon="Total-GPACRD-FTICs", caption = "FT2013-19")
```


### FTIC - 2013

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2013),  caption  = "FT13")
```

### CASSH

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2014),  caption  = "FT14")
```

### COB

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2015),  caption  = "FT15")

```

### UKCOH

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2016),  caption  ="FT16")

```

### CEPS

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2017), caption  ="FT17")

```

### No college designated

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2018), caption  ="FT18")

```

### FTIC - 2019

```{r}
valueBox(sum(myFTICGPACRDAPR$Cohort==2019), caption  = "FT19")

```

Row
-----------------------------------------------------------------------

### GPA + CRD Graduation by FTIC

```{r}
valueBox(paste("Graduation On-Time"), color="blue")
```

### Total Numbers of FTIC with GPA APR in UWF 

```{r}
FTIC_ALL_APR_CRD_DEG_firstV1 <- read_csv("FTIC_ALL_APR_CRD_DEG_firstV1.csv")
myFTICdeg <- FTIC_ALL_APR_CRD_DEG_firstV1[!is.na(FTIC_ALL_APR_CRD_DEG_firstV1$Deg_TermGranted),] 
valueBox(length(myFTICdeg$Deg_TermGranted), icon="Total-degree-FTICs", caption = "FTIC 2013-19")
```


### FTIC - 2013

```{r}
valueBox(sum(myFTICdeg$Cohort==2013 & myFTICdeg$Deg_TermGranted <= 201705 ),  caption  = "FT13")
```

### CASSH

```{r}
valueBox(sum(myFTICdeg$Cohort==2014 & myFTICdeg$Deg_TermGranted <= 201805),  caption  = "FT14")
```

### COB

```{r}
valueBox(sum(myFTICdeg$Cohort==2015 & myFTICdeg$Deg_TermGranted <= 201905),  caption  = "FT15")

```

### UKCOH

```{r}
valueBox(sum(myFTICdeg$Cohort==2016 & myFTICdeg$Deg_TermGranted <= 202005),  caption  ="FT16")

```

### CEPS

```{r}
valueBox(sum(myFTICdeg$Cohort==2017 & myFTICdeg$Deg_TermGranted <= 202105), caption  ="FT17")

```

### No college designated

```{r}
valueBox(sum(myFTICdeg$Cohort==2018 & myFTICdeg$Deg_TermGranted <= 202205), caption  ="FT18")

```

### FTIC - 2019

```{r}
valueBox(sum(myFTICdeg$Cohort==2019 & myFTICdeg$Deg_TermGranted <= 202305 ), caption  = "FT19")

```

Mean of University Credit Hours - No Bachelor Degree
========================================================================

### **FT2013 - Mean of Univ.Credit Hours**

```{r}
myFTIC2015 <- myFTIC %>% filter(Cohort==2013  & Stu_DEMO_TIME_FRAME.y==201908 )#& NumFallTerms >= 4
gauge(round(mean(myFTIC2015$Stu_TotalUniversityHours), digits = 2), min=0, max=150, gaugeSectors(success= c(120,150), warning = c(120,120),danger=c(0,120), colors = c("green","yellow","red")))
```


### **FT2014 - Mean of Univ.Credit Hours**

```{r}
myFTIC2015 <- myFTIC %>% filter(Cohort==2014 & Stu_DEMO_TIME_FRAME.y==201908)
gauge(round(mean(myFTIC2015$Stu_TotalUniversityHours), digits = 2), min=0, max=150, gaugeSectors(success= c(120,150), warning = c(120,120),danger=c(0,120), colors = c("green","yellow","red")))
```


### **FT2015 - Mean of Univ.Credit Hours**

```{r}
myFTIC2015 <- myFTIC %>% filter(Cohort==2015  & Stu_DEMO_TIME_FRAME.y==201908)
gauge(round(mean(myFTIC2015$Stu_TotalUniversityHours), digits = 2), min=0, max=150, gaugeSectors(success= c(120,150), warning = c(120,120),danger=c(0,120), colors = c("green","yellow","red")))
```


### **FT2016 - Mean of Univ.Credit Hours**

```{r}
myFTIC2016 <- myFTIC %>% filter(Cohort==2016  & Stu_DEMO_TIME_FRAME.y==201908)
gauge(round(mean(myFTIC2016$Stu_TotalUniversityHours), digits = 2), min=0, max=150, gaugeSectors(success= c(90,150), warning = c(90,90),danger=c(0,90), colors = c("green","yellow","red")))
```

### **FT2017 - Mean of Univ.Credit Hours**

```{r}

myFTIC2017 <- myFTIC %>% filter(Cohort==2017& Stu_DEMO_TIME_FRAME.y==201908)
gauge(round(mean(myFTIC2017$Stu_TotalUniversityHours), digits = 2), min=0, max=150, gaugeSectors(success= c(60,150), warning = c(60,60),danger=c(0,60), colors = c("green","yellow","red")))
```

### **FT2018 - Mean of Univ.Credit Hours**

```{r}
myFTIC2018 <- myFTIC %>% filter(Cohort==2018 & Stu_DEMO_TIME_FRAME.y==201908 )
gauge(round(mean(myFTIC2018$Stu_TotalUniversityHours), digits = 2), min=0, max=150, gaugeSectors(success= c(30,150), warning = c(30,30),danger=c(0,30), colors = c("green","yellow","red")))
```

### **FT2019 - Mean of Prior Univ. Hours**

```{r}
myFTIC2019 <- myFTIC %>% filter(Cohort==2019 & Stu_DEMO_TIME_FRAME.y==201908)
gauge(round(mean(myFTIC2019$Stu_TotalUniversityHours), digits = 2), min=0, max=150, gaugeSectors(success= c(0,150), warning = c(0,0),danger=c(0,0), colors = c("green","yellow","red")))
```


Charts
===================================================================
Row 
-------------------------------------------------------------------

### Numbers of FTIC by Cohort (Fall 2019)

```{r}
p1 <- myFTIC %>% filter(Stu_DEMO_TIME_FRAME.y==201908) %>% 
  group_by(Cohort) %>% 
  summarise(count=n()) %>% 
  plot_ly(x=~Cohort, y=~count, color = rainbow(7), type="bar") %>% 
  layout(xaxis=list(title="Cohort"), yaxis=list(title='Counts in Fall 2019'))

  p1
```


### University hours by Fall Terms

```{r}
myFTIC$Cohort <- as.factor(myFTIC$Cohort)
p3 <- ggplot(myFTIC[myFTIC$Stu_DEMO_TIME_FRAME.y==201908,], mapping = aes(x=NumFallTerms, y= Stu_TotalUniversityHours))+
  geom_jitter(mapping = aes(color=Cohort))+
  geom_smooth()+
  annotate("rect", xmin=4.5 , xmax =7.9 , ymin=0 , ymax=225 , color="darkred", alpha=0.25)+
  annotate("text", x=6, y=220, label="Over Time")+
  ggtitle("Total Univ.Hours for Each Falls by Cohort (Fall 2019)")
ggplotly(p3)
```


Row
----------------------------------------------------------------------

### Trends of Graduation Numbers with Bachelor Degree for each Term

```{r}
library(forecast)
deg201901 <- read.csv("C:/Users/jsparks3/Downloads/drive-download-20200901T135512Z-001/STUDENT_DEGREE_SPRING20.csv")
C <- deg201901 %>% filter(Deg_Desc=="Bachelor")
 tbs <- table(C$Deg_TermGranted)
tbst <- t(tbs)
mytbst <- as.data.frame(tbst)
myts <- mytbst$Freq # numbers of degree
 forecast(myts) %>% hchart()

```

### University Credit Hours VS. UWF Credit Hours by Cohort (Fall 2019)

```{r}
A <-  myFTIC %>% group_by(STU_ID) %>% filter(NumFallTerms==max(NumFallTerms))
myhchart <- hchart(A[A$Stu_DEMO_TIME_FRAME.y==201908,], "scatter",
                   hcaes(x=Stu_TotalInstHours, y=Stu_TotalUniversityHours , group=Cohort))
myhchart
```

 Data Table
============================================================================


```{r}
library(readr)
library(dplyr)
FTIC_ALL_APR_CRD_DEG_firstDemo <- read_csv("FTIC_ALL_APR_CRD_DEG_firstV1.csv", 
    col_types = cols(X1 = col_skip(), STU_ID = col_skip(), 
        Stu_DEMO_TIME_FRAME = col_number(), 
        Stu_LastInstitutionDesc = col_skip())) %>% select(Cohort,Stu_AdmissionTermCode,Stu_College,Stu_Department,Deg_College,Deg_Department,Deg_TermGranted) %>% 
  mutate(GraduationTime = ifelse((Cohort<=2015 & Deg_TermGranted <=201705)|(Cohort==2016 & Deg_TermGranted <=201805)|(Cohort==2017 & Deg_TermGranted <=201905)|(Cohort==201 & Deg_TermGranted <=202005), "OnTime","OverTime" )) 

colnames(FTIC_ALL_APR_CRD_DEG_firstDemo) <- c("Cohort","AdimissionTerm","Entry_college","Entry_deppart","Deg_college","Deg_depart","Deg_term","GraduationTime")

datatable(FTIC_ALL_APR_CRD_DEG_firstDemo[!is.na(FTIC_ALL_APR_CRD_DEG_firstDemo$Deg_term),], caption = "Graduation Time Data",
          filter = "top",
          options = list(pageLength=25))


```

 Pivot Table
========================================================================




 Summary
========================================================================

 Report 
========================================================================


